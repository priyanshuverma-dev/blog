<!doctype html><html lang=en><head><meta property="og:image" content="https://media2.dev.to/dynamic/image/width=1000,height=500,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fq77uo6x7kn3hdf7w1xe5.png"><meta name=twitter:image content="https://media2.dev.to/dynamic/image/width=1000,height=500,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fq77uo6x7kn3hdf7w1xe5.png"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="My Writings - Priyanshu Verma"><meta property="og:url" content="https://priyanshuverma-dev.github.io/blogs/deploy-fluvio-with-cloud-cluster-for-free./"><meta property="og:title" content="Deploy Fluvio with Cloud Cluster for free."><meta property="og:description" content="Hello builders, Many of you knows me but in case I am Priyanshu Verma, An Open-source Indie Developer.
In this Article we are going to talk about how you can deploy Fluvio integrated apps like APIs on internet for free. It is very easy to do so, As Today I will guide you how to. So, Without any delay let&rsquo;s see what to do.
As To deploy fluvio we need a project with it&rsquo;s integration. I have one from recent Fluvio Series. This is a basic Nodejs Express API with some endpoints and fluvio integration. I won&rsquo;t explain more about it you can explore this on GitHub. This article is just for deployment.
"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Deploy Fluvio with Cloud Cluster for free."><meta name=twitter:description content="Hello builders, Many of you knows me but in case I am Priyanshu Verma, An Open-source Indie Developer.
In this Article we are going to talk about how you can deploy Fluvio integrated apps like APIs on internet for free. It is very easy to do so, As Today I will guide you how to. So, Without any delay let&rsquo;s see what to do.
As To deploy fluvio we need a project with it&rsquo;s integration. I have one from recent Fluvio Series. This is a basic Nodejs Express API with some endpoints and fluvio integration. I won&rsquo;t explain more about it you can explore this on GitHub. This article is just for deployment.
"><meta name=description content="Hello builders, Many of you knows me but in case I am Priyanshu Verma, An Open-source Indie Developer.
In this Article we are going to talk about how you can deploy Fluvio integrated apps like APIs on internet for free. It is very easy to do so, As Today I will guide you how to. So, Without any delay let&rsquo;s see what to do.
As To deploy fluvio we need a project with it&rsquo;s integration. I have one from recent Fluvio Series. This is a basic Nodejs Express API with some endpoints and fluvio integration. I won&rsquo;t explain more about it you can explore this on GitHub. This article is just for deployment.
"><title>Deploy Fluvio with Cloud Cluster for free. | My Writings - Priyanshu Verma</title>
<link rel=canonical href=https://priyanshuverma-dev.github.io/blogs/deploy-fluvio-with-cloud-cluster-for-free./><link rel=icon type=image/png href=/blogs/favicon.ico><link rel=stylesheet href=/blogs/bundle.min.css></head><body><div id=body-wrapper><div id=left-wrapper></div><div id=center-wrapper><div id=header><div class="main-menu pure-menu pure-menu-horizontal"><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://priyanshuverma-dev.github.io/>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=/blogs/>Blog</a></li><li class=pure-menu-item><a class=pure-menu-link href=/blogs/tags/>Tags</a></li></ul><div class=translation-menu></div></div></div><div id=main><div class=post-title><h1>Deploy Fluvio with Cloud Cluster for free.</h1></div><div class=post-meta><span>2024-11-14</span>
&nbsp;
<a class=post-tag href=/blogs/tags/fluvio/>Fluvio</a>
&nbsp;
<a class=post-tag href=/blogs/tags/programming/>Programming</a>
&nbsp;
<a class=post-tag href=/blogs/tags/buildinpublic/>Buildinpublic</a>
&nbsp;
<a class=post-tag href=/blogs/tags/realtimedata/>Realtimedata</a></div><div class=post-content><p>Hello builders,
Many of you knows me but in case I am Priyanshu Verma, An Open-source Indie Developer.</p><p>In this Article we are going to talk about how you can deploy Fluvio integrated apps like APIs on internet for free.
It is very easy to do so, As Today I will guide you how to. So, Without any delay let&rsquo;s see what to do.</p><p>As To deploy fluvio we need a project with it&rsquo;s integration. I have one from recent <a href=https://dev.to/priyanshuverma/series/28713>Fluvio Series</a>.
This is a basic Nodejs Express API with some endpoints and fluvio integration. I won&rsquo;t explain more about it you can explore this on <a href=https://github.com/priyanshuverma-dev/fluvio-deploy-example>GitHub</a>. This article is just for deployment.</p><h2 id=my-project-tree>My Project Tree</h2><p>See the Project tree as that will help in understanding what I am say in later sections.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── Dockerfile
</span></span><span style=display:flex><span>├── bun.lockb
</span></span><span style=display:flex><span>├── cloud
</span></span><span style=display:flex><span>│   └── sinker.yml
</span></span><span style=display:flex><span>├── entrypoint.sh
</span></span><span style=display:flex><span>├── index.ts
</span></span><span style=display:flex><span>├── lib
</span></span><span style=display:flex><span>│   ├── fluvio.ts
</span></span><span style=display:flex><span>│   └── lib.ts
</span></span><span style=display:flex><span>├── package.json
</span></span><span style=display:flex><span>└── tsconfig.json
</span></span></code></pre></div><h2 id=1-create-an-account-on-infinyon-cloud>1. Create an account on Infinyon Cloud</h2><p>You need to create account on <a href=https://infinyon.cloud/ui/account>Infinyon Cloud</a> to make a cluster.</p><h2 id=2-install-fluvio-cli-locally>2. Install Fluvio CLI Locally</h2><p>You need to install Fluvio CLI locally for testing and adding connectors to cloud cluster in case we will add a <code>sinker</code> in a topic named <code>stocks-sinker</code> from a file in side <code>cloud</code> folder named <code>sinker.yml</code> you can see in project tree.
To install Fluvio CLI follow <a href=https://www.fluvio.io/docs/fluvio/quickstart>official Website</a>. Or follow me</p><p>Run command inside you terminal make sure on windows you use WSL.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsS https://hub.infinyon.cloud/install/install.sh | bash
</span></span></code></pre></div><p>After installation you need to add Fluvio to PATH by</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> echo <span style=color:#e6db74>&#39;export PATH=&#34;${HOME}/.fvm/bin:${HOME}/.fluvio/bin:${PATH}&#34;&#39;</span> &gt;&gt; ~/.zshrc
</span></span></code></pre></div><p>Now you will be able to use <code>fluvio</code> command in your terminal. If not then try again.</p><h2 id=3-login-with-your-credentials-and-push-connectors>3. Login with your Credentials and push connectors</h2><p>Now, We are going to login with our email and password in Fluvio CLI so, that we can have access to Cloud Clusters.
To do so run command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fluvio cloud login
</span></span></code></pre></div><p>It will ask for Email and Password Use what you created when signing in InfinyOn Cloud account.
You can check your clusters by command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fluvio cloud cluster list
</span></span></code></pre></div><p>If you have any then it will show you else it will show <code>No clusters found</code>. You can create cluster by the command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fluvio cloud cluster create
</span></span></code></pre></div><p>it will show something like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Creating cluster...
</span></span><span style=display:flex><span>Done!
</span></span><span style=display:flex><span>Downloading cluster config
</span></span><span style=display:flex><span>Switched to new profile: withered-frog
</span></span></code></pre></div><p>You will get any other Profile name at place of <code>withered-frog</code>.
Now, What you need to do is switch you profile to what you have created for me it is <code>withered-frog</code>. By default after creating a cluster you would be on that cluster&rsquo;s Profile. If you are not then switch to that. You can check it by command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fluvio profile
</span></span></code></pre></div><p>on case To switch use command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fluvio profile switch &lt;profile name&gt;
</span></span></code></pre></div><p><code>&lt;profile name></code> is the cluster you created in my case it would be <code>withered-frog</code>.</p><p>Now, Let&rsquo;s Push our connector on Cloud cluster which is
<code>/cloud/sinker.yml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>0.1.0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>meta</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>version</span>: <span style=color:#ae81ff>0.3.8</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>stocks-sinker</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>http-source</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>topic</span>: <span style=color:#ae81ff>stocks-sinker</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>endpoint</span>: <span style=color:#e6db74>&#34;http://deployed.url/sync&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>interval</span>: <span style=color:#ae81ff>120s</span>
</span></span></code></pre></div><p>I will change this <code>http://deployed.url/sync</code> to deployed URL later.
It is for my example project yours can be different and more then one.
To Push this connector will use command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fluvio cloud connector create --config cloud/sinker.yml
</span></span></code></pre></div><p>You will get something like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>connector <span style=color:#e6db74>&#34;stocks-sinker&#34;</span> <span style=color:#f92672>(</span>http-source<span style=color:#f92672>)</span> created
</span></span></code></pre></div><p>You can have multiple connector can be created similarly.</p><h2 id=4-store-credentials-to-deploy-and-dockerfile>4. Store Credentials To Deploy and Dockerfile</h2><p>From here we have two ways to build Docker Image for the Project. It depends on the Public and Private Project if your project is private and you can keep sensitive secret files in your codebase then you can go with approach A if your project is Public then you should go with approach B. You can select any method and tweak that with different tricks to save secrets.</p><h3 id=approach-a>Approach A</h3><p>For this I am assuming you have a codebase that can keep secret config files. To deploy we need a <code>config</code> file that we can use to login on server to get that inside terminal we need to export our profile by the command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>fluvio profile export &gt; config
</span></span></code></pre></div><p>It will export all configs in a file named <code>config</code> inside the folder.</p><p>Now, Create a <code>Dockerfile</code> like in project tree.</p><p>With the code of your project deploy pipelines</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> node:18</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENV</span> TZ<span style=color:#f92672>=</span>America/New_York<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> ln -snf /usr/share/zoneinfo/$TZ /etc/localtime <span style=color:#f92672>&amp;&amp;</span> echo $TZ &gt; /etc/timezone<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> apt-get update <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    apt-get install -y curl unzip tzdata <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    rm -rf /var/lib/apt/lists/*<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Install Fluvio</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> curl -fsS https://hub.infinyon.cloud/install/install.sh?ctx<span style=color:#f92672>=</span>dc | bash<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Set up environment variables in .bashrc</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> echo <span style=color:#e6db74>&#39;export PATH=&#34;$HOME/.fluvio/bin:$HOME/.fvm/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bashrc <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    echo <span style=color:#e6db74>&#39;source &#34;${HOME}/.fvm/env&#34;&#39;</span> &gt;&gt; ~/.bashrc<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Source .bashrc to ensure the environment variables are loaded</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> /bin/bash -c <span style=color:#e6db74>&#34;source ~/.bashrc&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Ensure correct permissions for the Fluvio binaries</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> chmod +x /root/.fluvio/bin/* /root/.fvm/bin/*<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Set the PATH (useful if running commands outside of an interactive shell)</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENV</span> PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$PATH<span style=color:#e6db74>:/root/.fluvio/bin:/root/.fvm/bin&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /app</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> package*.json ./<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> npm install -g bun<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Install Node.js dependencies</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> bun install<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Copy the rest of your application code</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> . .<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Copy the entrypoint script</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> cp ./config /root/.fluvio/<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>EXPOSE</span><span style=color:#e6db74> 3000</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>CMD</span> [ <span style=color:#e6db74>&#34;bun&#34;</span>,<span style=color:#e6db74>&#34;run&#34;</span>,<span style=color:#e6db74>&#34;dev&#34;</span> ]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>You can see it is self explanatory as the main thing is installing fluvio and adding config file that we exported to the path <code>/root/.fluvio/</code>.
You can also change the default path of fluvio config by adding a environment variable <code>FLV_PROFILE_PATH</code>. For now, I just copied to default path.
This was the first approach. Now you can deploy this on any free Platform with docker Image.
Will tell how to deploy after telling second Approach.</p><h3 id=approach-b>Approach B</h3><p>This is if your project is public on GitHub or if you can&rsquo;t keep secrets in codebase.
You also need to create a <code>Dockerfile</code> like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> node:18</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENV</span> TZ<span style=color:#f92672>=</span>America/New_York<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> ln -snf /usr/share/zoneinfo/$TZ /etc/localtime <span style=color:#f92672>&amp;&amp;</span> echo $TZ &gt; /etc/timezone<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> apt-get update <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    apt-get install -y curl unzip tzdata <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    rm -rf /var/lib/apt/lists/*<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Install Fluvio</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> curl -fsS https://hub.infinyon.cloud/install/install.sh?ctx<span style=color:#f92672>=</span>dc | bash<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Set up environment variables in .bashrc</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> echo <span style=color:#e6db74>&#39;export PATH=&#34;$HOME/.fluvio/bin:$HOME/.fvm/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bashrc <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    echo <span style=color:#e6db74>&#39;source &#34;${HOME}/.fvm/env&#34;&#39;</span> &gt;&gt; ~/.bashrc<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Source .bashrc to ensure the environment variables are loaded</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> /bin/bash -c <span style=color:#e6db74>&#34;source ~/.bashrc&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Ensure correct permissions for the Fluvio binaries</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> chmod +x /root/.fluvio/bin/* /root/.fvm/bin/*<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Set the PATH (useful if running commands outside of an interactive shell)</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENV</span> PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$PATH<span style=color:#e6db74>:/root/.fluvio/bin:/root/.fvm/bin&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /app</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> package*.json ./<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> npm install -g bun<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Install Node.js dependencies</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> bun install<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> . .<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Copy the entrypoint script</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> entrypoint.sh /usr/local/bin/entrypoint.sh<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Make the script executable</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> chmod +x /usr/local/bin/entrypoint.sh<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Set the entrypoint</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Expose the port your app runs on</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>EXPOSE</span><span style=color:#e6db74> 3000</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENTRYPOINT</span> [<span style=color:#e6db74>&#34;/usr/local/bin/entrypoint.sh&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>Here also we are doing same thing installing fluvio and running a file named <code>entrypoint.sh</code> which we have in codebase you can see in project tree.
Let&rsquo;s see what is inside the file <code>entrypoint.sh</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># Log in to Fluvio</span>
</span></span><span style=display:flex><span>fluvio cloud login --email $FLUVIO_CLOUD_EMAIL --password $FLUVIO_CLOUD_PASSWORD
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># syncing configs</span>
</span></span><span style=display:flex><span>fluvio cloud cluster sync
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start the application</span>
</span></span><span style=display:flex><span>exec bun run dev
</span></span></code></pre></div><p>Here you can see, We are getting <code>FLUVIO_CLOUD_EMAIL</code> and <code>FLUVIO_CLOUD_PASSWORD</code> from environment variables and logging in. Then we are syncing the config file.
You can set Environment Variables without exposing them and making it save.</p><h2 id=final-deploy>Final Deploy</h2><p>These were two methods to build Docker Image that we can deploy easily.
You can build Docker Image and publish that online like on Docker Hub to deploy that. For simplicity I will use GitHub to store my code and then deploy it with <code>Approach B</code>. I will use <a href=https://render.com/>Render</a> to deploy the Docker Image.</p><p>Firstly, Push the code to GitHub and create an account on <a href=https://render.com/>Render</a>. After that goto dashboard and create a new Web Service.</p><p><img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/nbr4krca8lcnxx9zii34.png alt="Image showing create a new Web Service button on Render"></p><p>After that Connect to GitHub and Select your project or fetch deployed Docker Image by Clicking <code>Existing Image</code></p><p><img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/j2r853a3pt8x3vtsflnw.png alt="on Render Buttons"></p><p>Then select Docker in language</p><p><img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0nksbrze9yi1hy4ph4q0.png alt="Render language section"></p><p>If you are doing with Approach B then add your environment Variables here like this</p><p><img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/dkfx449w1sj3glwq9qor.png alt="Render Env Section"></p><p>Then Deploy the Project and You are good to go 🎉!
This was the simplest Article about how you can deploy Fluvio using Docker and Render.</p><p>Example Project GitHub <a href=https://github.com/priyanshuverma-dev/fluvio-deploy-example>HERE</a>.</p><p>Try to give some approach to fellow developers how they can put secret config file in comments.</p><p>Thanks for reading&mldr;.</p></div></div><div id=footer><span class=post-meta>&copy; Priyanshu Verma &nbsp;2024
</span>&nbsp;
<a href=/blogs/sitemap.xml title=Sitemap target=_blank>Sitemap</a> &nbsp;
<a href=https://github.com/priyanshuverma-dev title=Github target=_blank>Github</a></div></div><div id=right-wrapper></div></div><script src=https://statstream.onrender.com/scripts/tracker data-nscript=afterInteractive></script></body></html>